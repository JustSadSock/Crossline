# Crossline

–ë—Ä–∞—É–∑–µ—Ä–Ω–∞—è –∞—Ä–µ–Ω–∞ —Å WebSocket-—Å–µ—Ä–≤–µ—Ä–æ–º. –ö–ª–∏–µ–Ω—Ç —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç –∫–∞–∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∞–π—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ Netlify)
–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ –∏ –æ—Ç–¥–∞–µ—Ç—Å—è –Ω–∞—Ä—É–∂—É —á–µ—Ä–µ–∑ —Ç—É–Ω–Ω–µ–ª—å.

## –ß—Ç–æ –≤—Ö–æ–¥–∏—Ç

- `/index.html`, `/scripts`, `/styles` ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ª–æ–±–±–∏ –∏ –∏–≥—Ä—ã.
- `/server` ‚Äî Node.js/WebSocket-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –º–∞—Ç—á–º–µ–π–∫–∏–Ω–≥–∞ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.
- `expose-server.bat` ‚Äî Windows-—Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–Ω–∏–º–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä –ª–æ–∫–∞–ª—å–Ω–æ –∏ —Å—Ä–∞–∑—É –ø—É–±–ª–∏–∫—É–µ—Ç –µ–≥–æ —á–µ—Ä–µ–∑ ngrok.
- `/scripts/runtime-config.js` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –ø—É–±–ª–∏—á–Ω—ã–º –∞–¥—Ä–µ—Å–æ–º —Ç—É–Ω–Ω–µ–ª—è.

## –ö–∞–∫ –≤—ã–¥–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –Ω–∞—Ä—É–∂—É (Windows)

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Node.js LTS](https://nodejs.org/) –∏ [ngrok](https://ngrok.com/). –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø—É—Ç—å –∫ `ngrok.exe`.
2. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –∑–∞–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω `NGROK_AUTHTOKEN`, —á—Ç–æ–±—ã —Ç—É–Ω–Ω–µ–ª—å –ø–æ–¥–Ω–∏–º–∞–ª—Å—è –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –ª–æ–≥–∏–Ω–∞.
3. –í –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∑–∞–ø—É—Å—Ç–∏—Ç–µ `expose-server.bat`. –°–∫—Ä–∏–ø—Ç:
   - –ø—Ä–æ–≤–µ—Ä–∏—Ç –Ω–∞–ª–∏—á–∏–µ Node.js –∏ npm;
   - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`npm ci`, —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ `node_modules`);
   - –∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–µ—Ä –Ω–∞ `http://localhost:3000` –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –æ–∫–Ω–µ;
   - –ø–æ–¥–Ω–∏–º–µ—Ç HTTPS-—Ç—É–Ω–Ω–µ–ª—å ngrok (`ngrok http %PORT% --scheme=https`) –∏ –≤—ã–≤–µ–¥–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π URL –≤ –∫–æ–Ω—Å–æ–ª–∏;
   - –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ `monitor-server.ps1` –æ—Ç–∫—Ä–æ–µ—Ç –æ–∫–Ω–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–π –∞–¥—Ä–µ—Å (—Ñ–æ—Ä–º–∞—Ç–∞ `https://*.ngrok.app`) –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
   –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –∑–∞–ø—É—Å–∫–∞ (—Å–º. –Ω–∏–∂–µ), —á—Ç–æ–±—ã –∏–≥—Ä–æ–∫–∏ –ø–æ–¥–∫–ª—é—á–∞–ª–∏—Å—å –∫ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É. –ò–º–µ–Ω–Ω–æ HTTPS-–∞–¥—Ä–µ—Å
   –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ –Ω–∞ HTTPS-–¥–æ–º–µ–Ω–µ WebSocket-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –ø–æ `wss://`,
   –±–µ–∑ –æ—à–∏–±–æ–∫ —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞

–§–∞–π–ª [`scripts/runtime-config.js`](scripts/runtime-config.js) —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–∞–π—Ç–æ–º –∏
–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫ –∫–∞–∫–æ–º—É —Ç—É–Ω–Ω–µ–ª—é –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç. –¢–µ–ø–µ—Ä—å —Å–∫—Ä–∏–ø—Ç –±–µ—Ä—ë—Ç –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–µ:

1. –ü–∞—Ä–∞–º–µ—Ç—Ä —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ `?server=https://example.eu.ngrok.app` (–∞ –¥–ª—è WebSocket ‚Äî `?ws=wss://‚Ä¶`).
2. –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `window.CROSSLINE_API_URL` / `window.CROSSLINE_WS_URL`, –µ—Å–ª–∏ –æ–Ω–∏ –∑–∞–¥–∞–Ω—ã –¥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞.
3. –ó–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è `CROSSLINE_API_URL` –∏ `CROSSLINE_WS_URL`, –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–±–æ—Ä—â–∏–∫–æ–º/—Ö–æ—Å—Ç–∏–Ω–≥–æ–º –≤–æ –≤—Ä–µ–º—è
   –±–∏–ª–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Netlify).

–ï—Å–ª–∏ –Ω–∏ –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω, –∫–ª–∏–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `window.location.origin`, —á—Ç–æ —É–¥–æ–±–Ω–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

> üí° –ù–∞ Netlify –∑–∞–¥–∞–π—Ç–µ `CROSSLINE_API_URL` –∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) `CROSSLINE_WS_URL` –≤ **Site settings ‚Üí Environment variables**.
> –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Ç—É–Ω–Ω–µ–ª—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Å–¥–µ–ª–∞—Ç—å –Ω–æ–≤—ã–π –¥–µ–ø–ª–æ–π ‚Äî –ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ.

### –ü–æ–ª–µ–∑–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è        | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                                      |
|-------------------|-----------------------------------------------------------------|
| `PORT`            | –õ–æ–∫–∞–ª—å–Ω—ã–π –ø–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `3000`).                   |
| `NGROK_EXE`       | –ü–æ–ª–Ω—ã–π –ø—É—Ç—å –¥–æ `ngrok.exe`, –µ—Å–ª–∏ –æ–Ω –Ω–µ –ø—Ä–æ–ø–∏—Å–∞–Ω –≤ `PATH`.       |
| `NGROK_AUTHTOKEN` | –¢–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ngrok; –µ—Å–ª–∏ –Ω–µ –∑–∞–¥–∞–Ω, ngrok –∑–∞–ø—Ä–æ—Å–∏—Ç –≤—Ö–æ–¥.    |
| `CROSSLINE_CORS_ORIGIN` | –î–æ–ø—É—Å—Ç–∏–º—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ CORS. –£–∫–∞–∂–∏—Ç–µ `https://crossfire-m.netlify.app/`, —á—Ç–æ–±—ã –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω-–∫–ª–∏–µ–Ω—Ç—É. –ú–æ–∂–Ω–æ –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–æ–º–µ–Ω–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é. |

> –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç —Å `Access-Control-Allow-Origin: *`, —á—Ç–æ —É–¥–æ–±–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏ –ø—É–±–ª–∏—á–Ω—ã—Ö API. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `CROSSLINE_CORS_ORIGIN` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä –≤ —Ä–µ–∂–∏–º ¬´–±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞¬ª –∏ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏–∑ –¥—Ä—É–≥–∏—Ö –¥–æ–º–µ–Ω–æ–≤.

## –†–∞–±–æ—Ç–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º

–û–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –∞–¥—Ä–µ—Å—É, —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –≤ `runtime-config.js`. –ï—Å–ª–∏ —Ç—É–Ω–Ω–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω,
–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–∫–∞–∂–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏ –æ—Ç–∫–ª—é—á–∏—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–∞ –≤ –∫–æ–º–Ω–∞—Ç—ã. –û—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º —Å –±–æ—Ç–æ–º –¥–æ—Å—Ç—É–ø–µ–Ω –±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞.

## –°–∫—Ä–∏–ø—Ç—ã npm

- `npm run test` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏ (`node --check server/index.js`).

## –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å—Ç–µ–∫

- Node.js 18+
- WebSocket (`ws`)
- –ß–∏—Å—Ç—ã–π JavaScript, Canvas –∏ CSS –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞

